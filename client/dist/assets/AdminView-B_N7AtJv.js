import{j as e,a2 as W,b as _,r as o,a3 as S,a4 as J,i as A,m as h}from"./index-CVZjuLi7.js";import{a as Z}from"./admin.api-BeVTebtN.js";import{F as d,I as T}from"./index-CHBvb3cU.js";import{s as ee}from"./index-CVfVAozb.js";import{R as y,C as c,B as n,S as se,M as x}from"./index-BjrRxxmI.js";import{R as te,D as i}from"./ArrowLeftOutlined-Bcpvk3le.js";import{o as ae}from"./createSvgIcon-DWg98uPe.js";import{R as re,a as oe,b as ne,c as le,d as ce,U as O,e as ie}from"./RestoreOutlined-kTamEd0u.js";import{R as de}from"./EditOutlined-B5RsWB_x.js";import{R as he}from"./DeleteOutlined-Bl3nP3f5.js";import{C as ue,T as me,a as pe}from"./index-DWbA25R3.js";import{A as xe,T as fe}from"./index-ClAXkO9a.js";import{R as je}from"./UserOutlined-jxMFrRgL.js";import{R as w,D as ge}from"./index-BxvyCBVr.js";import{S as ye}from"./index-D3eVkrds.js";import{R as be}from"./PlusOutlined-C1amfU3h.js";const D=ae([e.jsx("path",{d:"M6 20V10h12v1c.7 0 1.37.1 2 .29V10c0-1.1-.9-2-2-2h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h6.26c-.42-.6-.75-1.28-.97-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9z"},"0"),e.jsx("path",{d:"M18 13c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m1.65 7.35L17.5 18.2V15h1v2.79l1.85 1.85z"},"1")],"LockClockOutlined"),{Title:ke,Text:ve}=me,{TabPane:Ye}=pe,qe=()=>{var M;const{adminId:u}=W(),f=_(),[b]=d.useForm(),[s,L]=o.useState(null),[Ie,Te]=o.useState([]),[Ne,Ce]=o.useState([]),[k,j]=o.useState(!0),[B,m]=o.useState(!1),[$,v]=o.useState(!1),[N,I]=o.useState(!1),[E,g]=o.useState(!1),[V,C]=o.useState(!1),[l,p]=o.useState([]),[a,H]=ee.useMessage(),[U,P]=o.useState(!1);o.useEffect(()=>{R()},[u,U,N]);const R=async()=>{try{j(!0);const t=await Z(u);t.success?L(t.data):a.error("Failed to fetch admin data")}catch(t){console.error("Failed to fetch admin data:",t),a.error("Failed to fetch admin data")}finally{j(!1)}},F=t=>A(t).format("DD/MM/YYYY"),Y=()=>{const t={...s,dateOfBirth:s.dateOfBirth?A(s.dateOfBirth):null};b.setFieldsValue(t),I(!0)},q=async()=>{try{const t=await b.validateFields(),r=await h.put(`/employee/${s==null?void 0:s.employeeId}`,t);r.success?(I(!1),setTimeout(()=>{a.success(r.message)},200)):a.error(r.message)}catch(t){console.error("Failed to fetch admin data:",t),a.error("Failed to fetch admin data")}},z=async()=>{try{const t=s.employeeId,r=await h.post("/employee/reset-password",{employeeId:t});r.success?(a.success(r.message),setTimeout(()=>{f("/dashboard/admin")},1e3)):a.error(r.message),m(!1)}catch(t){console.error("Failed to fetch admin data:",t),a.error("Failed to fetch admin data")}},K=async()=>{try{const t=await h.put(`/admin/lock-account/${u}`);t.success?(a.success(t.message),setTimeout(()=>{f("/dashboard/admin")},1e3)):a.error(t.message),m(!1)}catch(t){console.error("Failed to fetch admin data:",t),a.error("Failed to fetch admin data")}},X=async()=>{try{const t=await h.put(`/admin/unlock-account/${u}`);t.success?(a.success(t.message),P(!0)):a.error(t.message),m(!1)}catch(t){console.error("Failed to fetch admin data:",t),a.error("Failed to fetch admin data")}},G=async()=>{try{const t=await h.delete(`/admin/${u}`);t.success?(a.success(t.message),setTimeout(()=>{f("/dashboard/admin")},1e3)):a.error(t.message),v(!1)}catch(t){console.error("Failed to delete admin:",t),a.error("Failed to delete admin")}},Q=async()=>{if(!l.length)return a.error("Please select an image to upload");j(!0);const t=new FormData;t.append("avatar",l[0].originFileObj);try{const r=await h.post(`/employee/change-avatar/${s.employeeId}`,t,{headers:{"Content-Type":"multipart/form-data"}});r.success?(g(!1),p([]),await R(),setTimeout(()=>{a.success(r.message)},200)):a.error(r.message||"Failed to update avatar")}catch(r){console.error("Failed to upload avatar:",r),a.error("Failed to upload avatar")}finally{j(!1)}};return k?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"500px"},children:e.jsx(S,{size:"large"})}):e.jsxs("div",{className:"p-6",children:[H,e.jsxs(y,{gutter:16,className:"mb-4",children:[e.jsx(c,{span:12,children:e.jsx(n,{icon:e.jsx(te,{}),onClick:()=>f("/dashboard/admin"),children:"Quay lại"})}),e.jsx(c,{span:12,style:{textAlign:"right"},children:e.jsx(se,{children:(s==null?void 0:s.isActive)!=="2"?e.jsxs(e.Fragment,{children:[e.jsx(n,{style:{backgroundColor:"darkturquoise"},icon:e.jsx(D,{}),onClick:()=>C(!0),children:"Khóa tài khoản"}),e.jsx(n,{style:{backgroundColor:"orange"},icon:e.jsx(re,{}),onClick:()=>m(!0),children:"Khôi phục mật khẩu"}),e.jsx(n,{icon:e.jsx(de,{}),onClick:Y,children:"Sửa"}),e.jsx(n,{type:"primary",danger:!0,icon:e.jsx(he,{}),onClick:()=>v(!0),children:"Xóa"})]}):e.jsx(e.Fragment,{children:e.jsx(n,{style:{backgroundColor:"royalblue"},icon:e.jsx(D,{}),onClick:X,children:"Mở khóa tài khoản"})})})})]}),e.jsx(ue,{className:"mb-4",children:e.jsxs(y,{gutter:24,children:[e.jsxs(c,{span:6,style:{textAlign:"center"},children:[e.jsxs("div",{className:"avatar-container",style:{position:"relative",display:"inline-block",borderRadius:"50%",cursor:"pointer"},onMouseEnter:t=>{t.currentTarget.querySelector(".avatar-hover-button").style.opacity=1},onMouseLeave:t=>{t.currentTarget.querySelector(".avatar-hover-button").style.opacity=0},children:[e.jsx(xe,{size:150,src:s==null?void 0:s.avatarUrl,icon:e.jsx(je,{})}),e.jsx("div",{className:"avatar-hover-button",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"rgba(0, 0, 0, 0.5)",borderRadius:"50%",opacity:0,transition:"opacity 0.3s",cursor:"pointer"},onClick:()=>g(!0),children:e.jsx(oe,{style:{fontSize:36,color:"white"}})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ke,{level:4,children:s==null?void 0:s.username}),e.jsx(ve,{type:"secondary",children:"ADMIN"}),e.jsx("div",{className:"mt-2",children:e.jsx(fe,{color:"blue",children:((M=s==null?void 0:s.departmentId)==null?void 0:M.name)||"No Department"})})]})]}),e.jsx(c,{span:18,children:e.jsxs(i,{title:"Thông tin chi tiết",bordered:!0,column:2,children:[e.jsx(i.Item,{label:"Họ và Tên",children:s==null?void 0:s.fullName}),e.jsxs(i.Item,{label:"Ngày sinh",children:[e.jsx(w,{className:"mr-1"})," ",F(s==null?void 0:s.dateOfBirth)]}),e.jsx(i.Item,{label:"Giới tính",children:(s==null?void 0:s.gender)==="MALE"?"Nam":(s==null?void 0:s.gender)==="FEMALE"?"Nữ":"Khác"}),e.jsxs(i.Item,{label:"Số điện thoại",children:[e.jsx(ne,{className:"mr-1"})," ",s==null?void 0:s.phoneNumber]}),e.jsxs(i.Item,{label:"Email",children:[e.jsx(le,{className:"mr-1"})," ",(s==null?void 0:s.email)||"N/A"]}),e.jsxs(i.Item,{label:"Địa chỉ",children:[e.jsx(ce,{className:"mr-1 mb-1"})," ",s==null?void 0:s.address]}),e.jsxs(i.Item,{label:"Ngày tuyển dụng",children:[e.jsx(w,{className:"mr-1"})," ",F(s==null?void 0:s.hireDate)]})]})})]})}),e.jsx(x,{title:"Xác nhận xóa",open:$,onOk:G,onCancel:()=>v(!1),okText:"Xóa",cancelText:"Hủy",okButtonProps:{danger:!0},children:e.jsxs("p",{children:["Bạn có chắc chắn muốn xóa tài khoản ",s==null?void 0:s.fullName," không ?"]})}),e.jsx(x,{title:"Xác nhận khóa tài khoản",open:V,onOk:K,onCancel:()=>C(!1),okText:"Khóa",cancelText:"Hủy",okButtonProps:{danger:!0},children:e.jsxs("p",{children:["Bạn có chắc chắn muốn khóa tài khoản ",s==null?void 0:s.fullName," không ?"]})}),e.jsx(x,{title:"Xác nhận khôi phục mật khẩu",open:B,onOk:z,onCancel:()=>m(!1),okText:"Khôi phục",cancelText:"Hủy",okButtonProps:{danger:!0},children:e.jsxs("p",{children:["Bạn có chắc chắn muốn khôi phục mật khẩu tài khoản ",s==null?void 0:s.fullName," không ?"]})}),e.jsx(x,{title:"Cập nhật thông tin admin",open:N,onCancel:()=>I(!1),onOk:q,okText:"Cập nhật",cancelText:"Hủy",okButtonProps:{style:{backgroundColor:"#1890ff"}},confirmLoading:k,width:800,destroyOnClose:!0,children:k?e.jsx("div",{style:{textAlign:"center",padding:"20px"},children:e.jsx(S,{tip:"Loading admin data..."})}):e.jsxs(d,{layout:"vertical",form:b,children:[e.jsxs(y,{gutter:16,children:[e.jsx(c,{span:12,children:e.jsx(d.Item,{name:"fullName",label:"Họ và Tên",rules:[{required:!0,message:"Nhập Họ và Tên"}],children:e.jsx(T,{placeholder:"Enter full name"})})}),e.jsx(c,{span:12,children:e.jsx(d.Item,{name:"dateOfBirth",label:"Ngày sinh",rules:[{required:!0,message:"Chọn ngày sinh"}],children:e.jsx(ge,{style:{width:"100%"},format:"DD/MM/YYYY"})})})]}),e.jsxs(y,{gutter:16,children:[e.jsx(c,{span:12,children:e.jsx(d.Item,{name:"gender",label:"Giới tính",rules:[{required:!0,message:"Chọn giới tính"}],children:e.jsxs(ye,{placeholder:"Select gender",children:[e.jsx(Option,{value:"MALE",children:"Nam"}),e.jsx(Option,{value:"FEMALE",children:"Nữ"}),e.jsx(Option,{value:"OTHER",children:"Khác"})]})})}),e.jsx(c,{span:12,children:e.jsx(d.Item,{name:"phoneNumber",label:"Số điện thoại",rules:[{required:!0,message:"Nhập số điện thoại"},{pattern:/^[0-9+\-\s]+$/,message:"Hãy nhập đúng định dạng số điện thoại"}],children:e.jsx(T,{placeholder:"Nhập số điện thoại"})})})]}),e.jsx(d.Item,{name:"address",label:"Địa chỉ",rules:[{required:!0,message:"Nhập địa chỉ"}],children:e.jsx(T.TextArea,{placeholder:"Nhập địa chỉ",rows:2})})]})}),e.jsxs(x,{title:"Thay đổi ảnh",open:E,onCancel:()=>{g(!1),p([])},footer:[e.jsx(n,{onClick:()=>{g(!1),p([])},children:"Hủy"},"cancel"),e.jsx(n,{okButtonProps:{style:{backgroundColor:"#1890ff"}},onClick:()=>Q(),disabled:l.length===0,children:"Tải"},"upload")],children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:16},children:[l.length>0&&e.jsx("div",{style:{marginBottom:16},children:e.jsx("img",{src:l[0].url||URL.createObjectURL(l[0].originFileObj),alt:"Avatar Preview",style:{width:150,height:150,borderRadius:"50%",objectFit:"cover",border:"1px solid #d9d9d9"}})}),e.jsx(O,{listType:"picture-card",showUploadList:!1,beforeUpload:t=>t.type.startsWith("image/")?(p([{uid:"-1",name:t.name,status:"done",originFileObj:t}]),!1):(a.error("You can only upload image files!"),O.LIST_IGNORE),children:l.length===0&&e.jsxs("div",{children:[e.jsx(be,{}),e.jsx("div",{style:{marginTop:8},children:"Upload"})]})}),l.length>0&&e.jsx(n,{icon:e.jsx(J,{}),danger:!0,onClick:()=>p([]),style:{marginTop:8},children:"Xóa"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(ie,{style:{color:"#1890ff",marginRight:8}}),e.jsx("span",{children:"Vui lòng chọn ảnh bạn muốn thay đổi và chọn Tải"})]})]})]})};export{qe as default};
