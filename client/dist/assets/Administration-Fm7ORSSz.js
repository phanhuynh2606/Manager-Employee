import{r as i,i as m,j as e,a0 as H}from"./index-Bwc4gm7I.js";import{g as O,c as q}from"./admin.api-DqUd5umi.js";import{F as n,I as h}from"./index-DdAIBUoZ.js";import{S as b,B as k,M as C,R as u,C as l}from"./index-BovoY_sW.js";import{S as A}from"./index-D116cBoH.js";import{R as B}from"./PlusOutlined-Bd1VFUAF.js";import{F as $}from"./Table-D6qVetiy.js";import{D as I}from"./index-CKgx11t8.js";import{A as P,T as M}from"./index-DJbP7_9A.js";import{R as V}from"./UserOutlined-apau3aZD.js";import{R as K}from"./EyeFilled-CbU4yb_I.js";import{R as _}from"./DeleteOutlined-B7xiUbAF.js";import{s as x}from"./index-OXkJZCqT.js";import"./iconUtil-CaOMBJ5Y.js";import"./Pagination-XJaDiIGl.js";const{Option:o}=A,oe=()=>{const[p,j]=i.useState([]),[f,g]=i.useState(!1),[z,S]=i.useState(null),[E,v]=i.useState(!1),[c]=n.useForm(),[d,T]=i.useState(""),[y,L]=i.useState("");i.useEffect(()=>{(async()=>{try{const t=await O();t.success&&j(t.data)}catch(t){console.error(t)}})()},[]);const D=()=>{v(!0),c.validateFields().then(async s=>{const t=await q(s);if(console.log(t),t.success){const r={id:Date.now(),...s};j(a=>[...a,r]),x.success(t.message),g(!1),c.resetFields(),S(null),v(!1)}else x.error("Thêm tài khoản thất bại")})},F=s=>{C.confirm({title:"Bạn chắc chắn muốn xóa tài khoản này chứ?",onOk:async()=>{j(r=>r.filter(a=>a.id!==s));const t=await axios.delete(`/admin/${s}`);t.success?x.success("Xóa tài khoản thành công"):x.error(t.message)}})},R=[{title:"ADMIN",dataIndex:"fullName",key:"fullName",render:(s,t)=>e.jsxs(b,{children:[e.jsx(P,{src:t.avatarUrl,icon:e.jsx(V,{}),size:"large"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:t.fullName}),e.jsx("div",{style:{fontSize:"13px",color:"#888"},children:t.phoneNumber})]})]})},{title:"Email",dataIndex:"email",key:"email"},{title:"Trạng thái",dataIndex:"isActive",key:"isActive",render:s=>{let t,r;switch(s){case"0":t="yellow",r="Chưa kích hoạt";break;case"1":t="green",r="Đã kích hoạt";break;case"2":t="red",r="Đã khóa"}return e.jsx(M,{color:t,children:r})}},{title:"Giới tính",dataIndex:"gender",key:"gender",render:s=>{let t=s==="MALE"?"blue":s==="FEMALE"?"pink":"default",r=s==="MALE"?"Nam":s==="FEMALE"?"Nữ":"Khác";return e.jsx(M,{color:t,children:r})}},{title:"Ngày tạo",dataIndex:"createdAt",key:"createdAt",render:s=>m(s).format("HH:mm:ss DD/MM/YYYY")},{title:"Hành động",key:"actions",render:(s,t)=>e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(H,{to:`/dashboard/admin/${t.id}`,children:e.jsx(k,{icon:e.jsx(K,{})})}),e.jsx(k,{danger:!0,icon:e.jsx(_,{}),onClick:()=>F(t.id)})]})}],Y=p==null?void 0:p.filter(s=>{var a,N,w;const t=((a=s==null?void 0:s.fullName)==null?void 0:a.toLowerCase().includes(d.toLowerCase()))||((N=s==null?void 0:s.email)==null?void 0:N.toLowerCase().includes(d.toLowerCase()))||((w=s==null?void 0:s.phoneNumber)==null?void 0:w.toLowerCase().includes(d.toLowerCase())),r=y===""||String(s.isActive)===y;return t&&r});return i.useEffect(()=>{f&&c.setFieldsValue({hireDate:m()})},[f,c]),e.jsxs("div",{className:"p-4 pt-2",children:[e.jsx("h1",{className:"text-xl font-bold mb-3",children:"Quản lý Admin"}),e.jsxs(b,{style:{marginBottom:16},children:[e.jsx(h,{placeholder:"Tìm kiếm theo tên, email hoặc số điện thoại",value:d,onChange:s=>T(s.target.value),style:{width:280}}),e.jsxs(A,{placeholder:"Lọc theo trạng thái",value:y,onChange:s=>L(s),style:{width:160},children:[e.jsx(o,{value:"",children:"Tất cả"}),e.jsx(o,{value:"0",children:"Chưa kích hoạt"}),e.jsx(o,{value:"1",children:"Đã kích hoạt"}),e.jsx(o,{value:"2",children:"Đã khóa"})]}),e.jsx(k,{type:"dashed",icon:e.jsx(B,{}),onClick:()=>g(!0),children:"Thêm Admin"})]}),e.jsx($,{dataSource:Y,columns:R,rowKey:"id"}),e.jsx(C,{title:"Thêm Admin",open:f,onCancel:()=>g(!1),onOk:D,okText:"Thêm",cancelText:"Hủy",okButtonProps:{style:{backgroundColor:"#1890ff"}},width:800,destroyOnClose:!0,confirmLoading:E,children:e.jsxs(n,{layout:"vertical",form:c,children:[e.jsxs(u,{gutter:16,children:[e.jsx(l,{span:12,children:e.jsx(n.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Hãy nhập email"},{type:"email",message:"Nhập đúng định dạng email"}],initialValues:{hireDate:m()},children:e.jsx(h,{placeholder:"Nhập email"})})}),e.jsx(l,{span:12,children:e.jsx(n.Item,{name:"fullName",label:"Họ và Tên",rules:[{required:!0,message:"Hãy nhập họ và tên"}],children:e.jsx(h,{placeholder:"Nhập họ và tên"})})})]}),e.jsxs(u,{gutter:16,children:[e.jsx(l,{span:12,children:e.jsx(n.Item,{name:"gender",label:"Giới tính",rules:[{required:!0,message:"Chọn giới tính"}],children:e.jsxs(A,{placeholder:"Chọn giới tính",children:[e.jsx(o,{value:"MALE",children:"Nam"}),e.jsx(o,{value:"FEMALE",children:"Nữ"}),e.jsx(o,{value:"OTHER",children:"Khác"})]})})}),e.jsx(l,{span:12,children:e.jsx(n.Item,{name:"phoneNumber",label:"Số điện thoại",rules:[{required:!0,message:"Hãy nhập số điện thoại"},{pattern:/^(0)[3-9][0-9]{8}$/,message:"Số điện thoại không hợp lệ (VD: 0901234567)"}],children:e.jsx(h,{placeholder:"Nhập số điện thoại"})})})]}),e.jsxs(u,{gutter:16,children:[e.jsx(l,{span:12,children:e.jsx(n.Item,{name:"dateOfBirth",label:"Ngày sinh",rules:[{required:!0,message:"Nhập ngày sinh nhật"},({getFieldValue:s})=>({validator(t,r){return r&&m().diff(r,"year")<18?Promise.reject(new Error("Người dùng phải đủ 18 tuổi")):Promise.resolve()}})],children:e.jsx(I,{style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Chọn ngày sinh nhật"})})}),e.jsx(l,{span:12,children:e.jsx(n.Item,{name:"address",label:"Địa chỉ",rules:[{required:!0,message:"Nhập địa chỉ"}],children:e.jsx(h.TextArea,{placeholder:"Nhập địa chỉ",rows:1})})})]}),e.jsx(u,{gutter:16,children:e.jsx(l,{span:12,children:e.jsx(n.Item,{name:"hireDate",label:"Ngày tuyển dụng",rules:[{required:!0,message:"Chọn ngày bắt đầu làm việc"}],children:e.jsx(I,{style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Ngày bắt đầu làm việc"})})})})]})})]})};export{oe as default};
