import{r as c,a2 as D,$ as N,j as e,a3 as R,a0 as Y,am as $}from"./index-CVZjuLi7.js";import{g as M,d as K}from"./salaries-C-KzLwir.js";import{m}from"./index-DTMZy5uy.js";import{T as L,C as h}from"./index-DWbA25R3.js";import{S as u,B as E,R as p,C as x,M as F}from"./index-BjrRxxmI.js";import{R as H,D as s}from"./ArrowLeftOutlined-Bcpvk3le.js";import{R as _}from"./UserOutlined-jxMFrRgL.js";import{D as d}from"./index-B0ryFktP.js";import{S as z,R as B}from"./index-BscTPlsp.js";import{F as a}from"./Table-CdKyJk3D.js";import{R as V}from"./DeleteFilled-DV3_mWzI.js";import"./index-D3eVkrds.js";import"./PlusOutlined-C1amfU3h.js";import"./EditOutlined-B5RsWB_x.js";import"./iconUtil-BCGkcafc.js";import"./Pagination-BWUH9pYp.js";function le(){const[n,f]=c.useState(null),[S,y]=c.useState(!1),{salaryId:g}=D(),{Title:I,Text:i}=L,k=N(r=>{var t,o;return(o=(t=r==null?void 0:r.auth)==null?void 0:t.user)==null?void 0:o.role});c.useEffect(()=>{j()},[]);const j=async()=>{try{y(!0);const r=await M(g);f(r.data)}catch(r){console.error("Failed to fetch salary data:",r)}finally{y(!1)}},l=r=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(r),T=async(r,t)=>{try{const o=await K(r,t);return j(),o}catch(o){console.error("Failed to delete salary",o),$.error({message:"Không thành công",description:o.message||"Có lỗi xảy ra, vui lòng thử lại!",placement:"topRight"})}},b=[{title:"Ngày",dataIndex:"day",key:"day",render:r=>`${r}/${n.month}/${n.year}`},{title:"Giờ làm việc",dataIndex:"workingHours",key:"workingHours"},{title:"Giờ làm thêm",dataIndex:"overTimeHours",key:"overTimeHours"},{title:"Thời gian bắt đầu",dataIndex:"periodStart",key:"periodStart",render:r=>r.split("T")[1].split(".")[0]},{title:"Thời gian kết thúc",dataIndex:"periodEnd",key:"periodEnd",render:r=>r.split("T")[1].split(".")[0]},{title:"Lương ngày",dataIndex:"salary",key:"salary",render:r=>l(r)},k==="ADMIN"?{title:"Hành động",dataIndex:"_id",key:"_id",render:r=>e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2 w-full cursor-pointer",onClick:()=>{F.confirm({title:"Xác nhận",content:`Bạn có chắc chắn muốn xóa ngày lương ${n.day}/${n.month}/${n.year}?`,okText:"Đồng ý",cancelText:"Hủy",okType:"danger",onOk:()=>T(g,r)})},children:[e.jsx(V,{})," Xóa"]})})}:!1].filter(Boolean),w=[{title:"Tên khoản phụ cấp",dataIndex:"name",key:"name"},{title:"Số tiền",dataIndex:"amount",key:"amount",render:r=>l(r)}],C=[{title:"Tên khoản thưởng",dataIndex:"name",key:"name"},{title:"Số tiền",dataIndex:"amount",key:"amount",render:r=>l(r)},{title:"Lý do",dataIndex:"reason",key:"reason"}],v=[{title:"Tên khoản khấu trừ",dataIndex:"name",key:"name"},{title:"Số tiền",dataIndex:"amount",key:"amount",render:r=>l(r)},{title:"Lý do",dataIndex:"reason",key:"reason"}];return S?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(R,{size:"large",tip:"Đang tải thông tin lương..."})}):e.jsx("div",{className:"p-8",children:e.jsxs(u,{direction:"vertical",size:"large",className:"w-full",children:[e.jsx("div",{children:e.jsx(E,{type:"link",icon:e.jsx(H,{}),children:e.jsx(Y,{to:"/dashboard/salaries",children:"Quay lại danh sách lương"})})}),n&&e.jsx(e.Fragment,{children:e.jsx(h,{children:e.jsxs(u,{direction:"vertical",size:"middle",className:"w-full",children:[e.jsxs(p,{gutter:16,align:"middle",children:[e.jsx(x,{children:e.jsx(_,{style:{fontSize:"24px"}})}),e.jsxs(x,{children:[e.jsx(I,{level:4,style:{margin:0},children:n.employeeId.fullName}),e.jsx(i,{type:"secondary",children:n.employeeId.position})]})]}),e.jsx(d,{}),e.jsxs(s,{title:"Thông tin lương",bordered:!0,column:{xxl:4,xl:3,lg:3,md:2,sm:1,xs:1},children:[e.jsx(s.Item,{label:"Tháng/Năm",children:`${n.month}/${n.year}`}),e.jsx(s.Item,{label:"Lương cơ bản",children:l(n.baseSalary)}),e.jsx(s.Item,{label:"Ngày bắt đầu",children:m(n.periodStart).format("DD/MM/YYYY")}),e.jsx(s.Item,{label:"Ngày kết thúc",children:m(n.periodEnd).format("DD/MM/YYYY")}),e.jsx(s.Item,{label:"Ngày thanh toán",children:m(n.paymentDate).format("DD/MM/YYYY")}),e.jsx(s.Item,{label:"Ghi chú",span:2,children:n.note||"Không có"})]}),e.jsx(p,{gutter:16,children:e.jsx(x,{xs:24,sm:8,children:e.jsx(h,{children:e.jsx(z,{title:"Tổng lương",value:n.totalSalary,precision:2,valueStyle:{color:"#3f8600"},prefix:e.jsx(B,{}),formatter:r=>Math.ceil(r).toLocaleString()+" ₫"})})})}),e.jsx(d,{orientation:"left",children:"Chi tiết lương theo ngày"}),e.jsx(a,{dataSource:n.daySalary,columns:b,rowKey:"_id",pagination:!1,bordered:!0,summary:()=>e.jsxs(a.Summary.Row,{children:[e.jsx(a.Summary.Cell,{index:0,colSpan:5,children:e.jsx(i,{strong:!0,children:"Tổng"})}),e.jsx(a.Summary.Cell,{index:1,children:e.jsx(i,{strong:!0,children:l(n.daySalary.reduce((r,t)=>r+t.salary,0))})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(d,{orientation:"left",children:"Phụ cấp"}),e.jsx(a,{dataSource:n.allowances,columns:w,rowKey:"_id",pagination:!1,bordered:!0,summary:()=>e.jsxs(a.Summary.Row,{children:[e.jsx(a.Summary.Cell,{index:0,children:e.jsx(i,{strong:!0,children:"Tổng phụ cấp"})}),e.jsx(a.Summary.Cell,{index:1,children:e.jsx(i,{strong:!0,children:l(n.allowances.reduce((r,t)=>r+t.amount,0))})})]})})]}),e.jsxs("div",{children:[e.jsx(d,{orientation:"left",children:"Thưởng"}),e.jsx(a,{dataSource:n.bonuses,columns:C,rowKey:"_id",pagination:!1,bordered:!0,summary:()=>e.jsxs(a.Summary.Row,{children:[e.jsx(a.Summary.Cell,{index:0,colSpan:2,children:e.jsx(i,{strong:!0,children:"Tổng thưởng"})}),e.jsx(a.Summary.Cell,{index:2,children:e.jsx(i,{strong:!0,children:l(n.bonuses.reduce((r,t)=>r+t.amount,0))})})]})})]})]}),e.jsx(d,{orientation:"left",children:"Khấu trừ"}),e.jsx(a,{dataSource:n.deductions,columns:v,rowKey:"_id",pagination:!1,bordered:!0,summary:()=>e.jsxs(a.Summary.Row,{children:[e.jsx(a.Summary.Cell,{index:0,colSpan:2,children:e.jsx(i,{strong:!0,children:"Tổng khấu trừ"})}),e.jsx(a.Summary.Cell,{index:2,children:e.jsx(i,{strong:!0,children:l(n.deductions.reduce((r,t)=>r+t.amount,0))})})]})}),e.jsx(h,{title:"Chi tiết tính lương",bordered:!1,children:e.jsxs(s,{column:1,children:[e.jsx(s.Item,{label:"Tổng lương thoe ngày",children:l(n.daySalary.reduce((r,t)=>r+t.salary,0))}),e.jsx(s.Item,{label:"+ Tổng phụ cấp",children:l(n.allowances.reduce((r,t)=>r+t.amount,0))}),e.jsx(s.Item,{label:"+ Tổng thưởng",children:l(n.bonuses.reduce((r,t)=>r+t.amount,0))}),e.jsx(s.Item,{label:"- Tổng khấu trừ",children:l(n.deductions.reduce((r,t)=>r+t.amount,0))}),e.jsx(s.Item,{label:"= Tổng lương",children:e.jsx(i,{strong:!0,style:{color:"#3f8600",fontSize:"16px"},children:l(n.totalSalary)})})]})})]})})})]})})}export{le as default};
